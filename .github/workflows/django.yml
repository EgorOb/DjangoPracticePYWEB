name: Django CI

on:
# Если хотим чтобы при любом push в master запускался контейнер, что не самое удобное
#   push:
#     branches: [ "master" ]
  pull_request: # Запускать будем только при пулл реквесте в master
    branches: [ "master" ]

jobs:
  build:
    runs-on: ubuntu-latest
    env: # Заносим переменные в окружение контейнера
      ALLOWED_HOSTS: ${{ secrets.ALLOWED_HOSTS }}
      DEBUG: ${{ secrets.DEBUG }}
      SECRET_KEY: ${{ secrets.SECRET_KEY }}
    steps:
#     - name: Checkout to container
#       uses: actions/checkout@v3
#     - name: Set up Python 3.10
#       uses: actions/setup-python@v4
#       with:
#         python-version: '3.10'
#     - name: Install Dependencies
#       run: |
#         python -m pip install --upgrade pip
#         pip install -r requirements.txt
# # Раскомментировать если есть необходимость конкретные переменные в окружении
# #     - name: Use multiple secrets
# #       run: |
# #         echo "$ALLOWED_HOSTS"
# #         echo "$DEBUG"
# #         echo "$SECRET_KEY"
# # Раскомментировать если есть необходимость посмотреть все переменные окружения в контейнере
# #     - name: Check environment variables
# #       run: env
#     - name: Run Tests
#       run: |
#         python manage.py test
# #     - name: Merge pull request
# #       uses: repo-sync/github-sync@master
# #       with:
# #         source_repo: EgorOb/DjangoPracticePYWEB  # Замените на своё значение
# #         source_branch: ${{ github.ref }}
# #         destination_branch: master
# #         github_token: ${{ secrets.GITHUB_TOKEN }}
# #         sync_tags: true
      - name: automerge
        uses: "pascalgn/automerge-action@v0.15.6"
        env:
          GITHUB_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
#       - name: feedback
#         if: 'steps.automerge.outputs.mergeResult == merged'
#         run: |
#           echo "Pull request ${{ steps.automerge.outputs.pullRequestNumber }} merged!"
